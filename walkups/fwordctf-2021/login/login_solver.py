from pwn import *

r = remote('52.149.135.130', 4871)
#r = process(['python3', 'login.py'])
r.recvuntil(b'>')
r.sendline(b'1')
r.recvuntil(b'Username : ')
r.sendline(b'a;is_admin=true')
#r.recvuntil(b'Input ')
#print('Input', r.readline())
r.recvuntil(b'Username : ')
username = r.recvline().strip()
r.recvuntil(b'Password : ')
password = r.recvline().strip()
r.recvuntil(b'Proof : ')
proof = r.recvline().strip()
r.recvuntil(b'>')
r.sendline(b'2')
r.recvuntil(b'Username : ')
r.sendline(b'a'.hex().encode())
r.recvuntil(b'Password : ')
r.sendline(password)
r.recvuntil(b'Proof : ')
r.sendline(b'is_admin=true;is_admin=false'.hex().encode())
r.recvuntil(b'Welcome admin, to continue you need to sign this message : ')
msg = r.recvline().strip()
msg = b"https://twitter.com/CTFCreators"
r.recvuntil('e : ')
e = int(r.recvline().strip(), 16)
r.recvuntil('d : ')
d = int(r.recvline().strip(), 16)
r.recvuntil('inverse(p, q) : ')
shit = int(r.recvline().strip(), 16)
print(e*d)
